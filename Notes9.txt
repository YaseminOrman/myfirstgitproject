This the c ode in my branch